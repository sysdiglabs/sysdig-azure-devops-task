<!DOCTYPE html>
<html>
<head>
    <script src="https://cdn.vsassets.io/v/M142_20211006.6/_scripts/TFS/min/VSS.SDK.js"></script>
</head>
<body>
    <div id="htmlContent">Loading...</div>

    <script>
        VSS.init({
            explicitNotifyLoaded: true,
            usePlatformScripts: true,
            usePlatformStyles: true
        });

        VSS.require("TFS/DistributedTask/TaskRestClient", function(TFS_DT) {
            VSS.ready(function() {
                var projectId = VSS.getWebContext().project.id;
                var buildId = VSS.getConfiguration().data.id;

                var client = TFS_DT.getClient();
                client.getPlanAttachments(projectId, "build", buildId, "htmlReport").then(function(attachments) {
                    var attachment = attachments[0]; // assuming there is one attachment with the name "htmlReport"
                    client.getAttachmentContent(projectId, "build", buildId, attachment.timelineId, attachment.recordId, attachment.type, attachment.name).then(function(content) {
                        // Assuming the content is a string. If binary, you would need to handle it differently.
                        var htmlContent = new TextDecoder('utf-8').decode(content);
                        document.getElementById("htmlContent").innerHTML = htmlContent;
                    });
                });
            });
        });

        VSS.notifyLoadSucceeded();
    </script>
</body>
</html>
